<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADRIANO MORAES | Consultoria Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Adicionando SDK do Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3f37c9;
            --dark: #1b263b;
            --light: #f8f9fa;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --info: #560bad;
            --border-radius: 8px;
            --box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 20px auto;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }

        header {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }

        header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        header p {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        .progress-container {
            width: 100%;
            background-color: rgba(255, 255, 255, 0.2);
            height: 8px;
            border-radius: 4px;
            margin-top: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            width: 25%;
            background-color: white;
            transition: var(--transition);
        }

        .form-container {
            padding: 30px;
        }

        .tab-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 25px;
        }

        .tab-button {
            flex: 1;
            min-width: 120px;
            padding: 12px;
            background-color: #e9ecef;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            color: var(--dark);
            transition: var(--transition);
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .tab-button i {
            font-size: 1.1rem;
        }

        .tab-button:hover {
            background-color: #dee2e6;
        }

        .tab-button.active {
            background-color: var(--primary);
            color: white;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }

        .form-group label.required:after {
            content: " *";
            color: var(--danger);
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ced4da;
            border-radius: var(--border-radius);
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary-light);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }

        .radio-group, .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-item, .checkbox-item {
            display: flex;
            align-items: center;
        }

        .radio-item input, .checkbox-item input {
            margin-right: 10px;
            width: 18px;
            height: 18px;
        }

        .food-category {
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 15px;
            margin-bottom: 20px;
        }

        .food-category h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .food-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
        }

        .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-prev {
            background-color: #6c757d;
            color: white;
        }

        .btn-prev:hover {
            background-color: #5a6268;
        }

        .btn-next, .btn-submit {
            background-color: var(--primary);
            color: white;
        }

        .btn-next:hover, .btn-submit:hover {
            background-color: var(--secondary);
        }

        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            color: var(--primary-light);
            cursor: help;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: white;
            text-align: center;
            border-radius: var(--border-radius);
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: var(--transition);
            font-size: 0.9rem;
            font-weight: normal;
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .age-display {
            display: inline-block;
            margin-left: 10px;
            font-weight: normal;
            color: var(--primary);
            font-size: 0.9rem;
        }

        .error-message {
            color: var(--danger);
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--success);
            color: white;
            padding: 12px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: var(--transition);
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .photo-upload {
            border: 2px dashed #ced4da;
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 20px;
        }

        .photo-upload:hover {
            border-color: var(--primary-light);
            background-color: rgba(67, 97, 238, 0.05);
        }

        .photo-upload i {
            font-size: 2rem;
            color: var(--primary-light);
            margin-bottom: 10px;
        }

        .photo-upload p {
            margin-bottom: 5px;
        }

        .photo-upload small {
            color: #6c757d;
        }

        .photo-preview {
            display: none;
            margin-top: 15px;
            text-align: center;
        }

        .photo-preview img {
            max-width: 100%;
            max-height: 200px;
            border-radius: var(--border-radius);
            border: 1px solid #ced4da;
        }

        .bmi-result {
            display: none;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            padding: 15px;
            margin-top: 15px;
            text-align: center;
        }

        .bmi-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            margin: 5px 0;
        }

        .bmi-classification {
            font-weight: 600;
        }

        .other-foods {
            margin-top: 20px;
        }

        .disclaimer-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .disclaimer-content {
            background-color: white;
            padding: 30px;
            border-radius: var(--border-radius);
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .disclaimer-content h2 {
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .disclaimer-content p {
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .disclaimer-accept {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 25px;
        }

        .disclaimer-accept label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .disclaimer-accept input {
            width: 18px;
            height: 18px;
        }

        .disclaimer-accept button {
            padding: 12px;
            border: none;
            border-radius: var(--border-radius);
            background-color: var(--primary);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .disclaimer-accept button:hover {
            background-color: var(--secondary);
        }

        .disclaimer-accept button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        @media (max-width: 768px) {
            .container {
                border-radius: 0;
            }

            .tab-button {
                padding: 10px;
                font-size: 0.9rem;
            }

            .form-container {
                padding: 20px;
            }

            .food-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }

            .button-container {
                flex-direction: column-reverse;
                gap: 10px;
            }

            .btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            header h1 {
                font-size: 1.5rem;
            }

            header p {
                font-size: 0.85rem;
            }

            .tab-buttons {
                flex-direction: column;
            }

            .food-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-heartbeat"></i> ADRIANO MORAES Consultoria Online</h1>
            <p>Preencha o questionário para receber sua consultoria personalizada</p>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
        </header>

        <div class="form-container">
            <form id="consultationForm">
                <div class="tab-buttons">
                    <button type="button" class="tab-button active" data-tab="personalData">
                        <i class="fas fa-user"></i> Dados Pessoais
                    </button>
                    <button type="button" class="tab-button" data-tab="healthData">
                        <i class="fas fa-heart"></i> Saúde
                    </button>
                    <button type="button" class="tab-button" data-tab="fitnessData">
                        <i class="fas fa-dumbbell"></i> Físico
                    </button>
                    <button type="button" class="tab-button" data-tab="dietData">
                        <i class="fas fa-utensils"></i> Dieta
                    </button>
                </div>

                <!-- Tab 1: Dados Pessoais -->
                <div id="personalData" class="tab-content active">
                    <div class="form-group">
                        <label for="fullName" class="required">Nome Completo</label>
                        <input type="text" id="fullName" name="fullName" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email" class="required">E-mail
                            <span class="tooltip">
                                <i class="fas fa-info-circle"></i>
                                <span class="tooltip-text">Informe um e-mail válido que você utiliza regularmente</span>
                            </span>
                        </label>
                        <input type="email" id="email" name="email" class="form-control" required>
                        <div class="error-message" id="email-error">Por favor, insira um e-mail válido</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="phone" class="required">Telefone
                            <span class="tooltip">
                                <i class="fas fa-info-circle"></i>
                                <span class="tooltip-text">Informe com DDD no formato (XX) XXXX-XXXX</span>
                            </span>
                        </label>
                        <input type="tel" id="phone" name="phone" class="form-control" required placeholder="(99) 99999-9999">
                        <div class="error-message" id="phone-error">Formato inválido. Use (XX) XXXX-XXXX</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="birthDate" class="required">Data de Nascimento
                            <span id="ageDisplay" class="age-display"></span>
                        </label>
                        <input type="date" id="birthDate" name="birthDate" class="form-control" required>
                        <div class="error-message" id="birthdate-error">Data inválida ou idade menor que 12 anos</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="address" class="required">Endereço</label>
                        <input type="text" id="address" name="address" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="cep" class="required">CEP
                            <span class="tooltip">
                                <i class="fas fa-info-circle"></i>
                                <span class="tooltip-text">Informe apenas números (8 dígitos)</span>
                            </span>
                        </label>
                        <input type="text" id="cep" name="cep" class="form-control" required placeholder="99999-999">
                        <div class="error-message" id="cep-error">CEP inválido. Use 99999-999 ou 99999999</div>
                    </div>
                    
                    <div class="form-group">
                        <label class="required">Sexo Biológico</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="male" name="gender" value="Masculino" required>
                                <label for="male">Masculino</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="female" name="gender" value="Feminino">
                                <label for="female">Feminino</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="otherGender" name="gender" value="Outro">
                                <label for="otherGender">Outro</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="profession">Profissão</label>
                        <input type="text" id="profession" name="profession" class="form-control">
                    </div>
                </div>

                <!-- Tab 2: Dados de Saúde -->
                <div id="healthData" class="tab-content">
                    <div class="form-group">
                        <label>Possui algum problema de saúde diagnosticado?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="healthProblemYes" name="healthProblem" value="Sim">
                                <label for="healthProblemYes">Sim</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="healthProblemNo" name="healthProblem" value="Não" checked>
                                <label for="healthProblemNo">Não</label>
                            </div>
                        </div>
                        <textarea id="healthProblemDescription" name="healthProblemDescription" class="form-control" placeholder="Se sim, quais?" style="margin-top: 10px; display: none;"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Toma algum medicamento regularmente?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="medicationYes" name="medication" value="Sim">
                                <label for="medicationYes">Sim</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="medicationNo" name="medication" value="Não" checked>
                                <label for="medicationNo">Não</label>
                            </div>
                        </div>
                        <textarea id="medicationDescription" name="medicationDescription" class="form-control" placeholder="Se sim, quais?" style="margin-top: 10px; display: none;"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Possui alguma alergia?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="allergyYes" name="allergy" value="Sim">
                                <label for="allergyYes">Sim</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="allergyNo" name="allergy" value="Não" checked>
                                <label for="allergyNo">Não</label>
                            </div>
                        </div>
                        <textarea id="allergyDescription" name="allergyDescription" class="form-control" placeholder="Se sim, quais?" style="margin-top: 10px; display: none;"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Já sofreu alguma lesão ou cirurgia?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="injuryYes" name="injury" value="Sim">
                                <label for="injuryYes">Sim</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="injuryNo" name="injury" value="Não" checked>
                                <label for="injuryNo">Não</label>
                            </div>
                        </div>
                        <textarea id="injuryDescription" name="injuryDescription" class="form-control" placeholder="Se sim, quais?" style="margin-top: 10px; display: none;"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Fuma?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="smokerYes" name="smoker" value="Sim">
                                <label for="smokerYes">Sim</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="smokerNo" name="smoker" value="Não" checked>
                                <label for="smokerNo">Não</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Consome bebidas alcoólicas?</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="alcoholYes" name="alcohol" value="Sim">
                                <label for="alcoholYes">Sim</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="alcoholNo" name="alcohol" value="Não" checked>
                                <label for="alcoholNo">Não</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="stressLevel">Qual seu nível de estresse no dia a dia?</label>
                        <select id="stressLevel" name="stressLevel" class="form-control">
                            <option value="Baixo">Baixo</option>
                            <option value="Moderado" selected>Moderado</option>
                            <option value="Alto">Alto</option>
                            <option value="Muito Alto">Muito Alto</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="sleepQuality">Qual a qualidade do seu sono?</label>
                        <select id="sleepQuality" name="sleepQuality" class="form-control">
                            <option value="Excelente">Excelente</option>
                            <option value="Boa" selected>Boa</option>
                            <option value="Regular">Regular</option>
                            <option value="Ruim">Ruim</option>
                            <option value="Muito Ruim">Muito Ruim</option>
                        </select>
                    </div>
                </div>

                <!-- Tab 3: Avaliação Física -->
                <div id="fitnessData" class="tab-content">
                    <div class="form-group">
                        <label for="height" class="required">Altura (cm)</label>
                        <input type="number" id="height" name="height" class="form-control" min="100" max="250" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="weight" class="required">Peso (kg)</label>
                        <input type="number" id="weight" name="weight" class="form-control" min="30" max="300" step="0.1" required>
                    </div>
                    
                    <div class="form-group">
                        <button type="button" id="calculateBMI" class="btn" style="background-color: var(--info);">
                            <i class="fas fa-calculator"></i> Calcular IMC
                        </button>
                        <div class="bmi-result" id="bmiResult">
                            <p>Seu Índice de Massa Corporal (IMC) é:</p>
                            <div class="bmi-value" id="bmiValue">--</div>
                            <p class="bmi-classification" id="bmiClassification">Classificação</p>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="bodyFat">Percentual de Gordura Corporal (opcional)</label>
                        <input type="number" id="bodyFat" name="bodyFat" class="form-control" min="5" max="60" step="0.1">
                    </div>
                    
                    <div class="photo-upload" id="photoUpload">
                        <i class="fas fa-camera"></i>
                        <p>Clique para adicionar fotos para avaliação física</p>
                        <small>Recomendamos fotos de frente, perfil e costas</small>
                        <input type="file" id="photoInput" accept="image/*" multiple style="display: none;">
                    </div>
                    
                    <div class="photo-preview" id="photoPreview"></div>
                    
                    <div class="form-group">
                        <label for="fitnessGoal" class="required">Qual seu principal objetivo?</label>
                        <select id="fitnessGoal" name="fitnessGoal" class="form-control" required>
                            <option value="">Selecione...</option>
                            <option value="Perda de peso">Perda de peso</option>
                            <option value="Ganho de massa muscular">Ganho de massa muscular</option>
                            <option value="Melhora da resistência">Melhora da resistência</option>
                            <option value="Melhora da flexibilidade">Melhora da flexibilidade</option>
                            <option value="Melhora da saúde geral">Melhora da saúde geral</option>
                            <option value="Preparação para competição">Preparação para competição</option>
                            <option value="Reabilitação">Reabilitação</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="activityLevel" class="required">Nível de atividade física atual</label>
                        <select id="activityLevel" name="activityLevel" class="form-control" required>
                            <option value="">Selecione...</option>
                            <option value="Sedentário">Sedentário (pouco ou nenhum exercício)</option>
                            <option value="Levemente ativo">Levemente ativo (exercício leve 1-3 dias/semana)</option>
                            <option value="Moderadamente ativo">Moderadamente ativo (exercício moderado 3-5 dias/semana)</option>
                            <option value="Muito ativo">Muito ativo (exercício intenso 6-7 dias/semana)</option>
                            <option value="Extremamente ativo">Extremamente ativo (exercício muito intenso + trabalho físico)</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="workDescription">Descreva seu trabalho/rotina diária</label>
                        <textarea id="workDescription" name="workDescription" class="form-control" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label class="required">Dias disponíveis para treino</label>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="monday" name="availableDays" value="Segunda">
                                <label for="monday">Segunda-feira</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="tuesday" name="availableDays" value="Terça">
                                <label for="tuesday">Terça-feira</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="wednesday" name="availableDays" value="Quarta">
                                <label for="wednesday">Quarta-feira</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="thursday" name="availableDays" value="Quinta">
                                <label for="thursday">Quinta-feira</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="friday" name="availableDays" value="Sexta">
                                <label for="friday">Sexta-feira</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="saturday" name="availableDays" value="Sábado">
                                <label for="saturday">Sábado</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="sunday" name="availableDays" value="Domingo">
                                <label for="sunday">Domingo</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="availableTime" class="required">Melhor horário para treino</label>
                        <select id="availableTime" name="availableTime" class="form-control" required>
                            <option value="">Selecione...</option>
                            <option value="Manhã (6h-12h)">Manhã (6h-12h)</option>
                            <option value="Tarde (12h-18h)">Tarde (12h-18h)</option>
                            <option value="Noite (18h-23h)">Noite (18h-23h)</option>
                            <option value="Variável">Variável</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="trainingDuration" class="required">Tempo disponível por sessão de treino</label>
                        <select id="trainingDuration" name="trainingDuration" class="form-control" required>
                            <option value="">Selecione...</option>
                            <option value="30 minutos">30 minutos</option>
                            <option value="45 minutos">45 minutos</option>
                            <option value="60 minutos">60 minutos</option>
                            <option value="75 minutos">75 minutos</option>
                            <option value="90 minutos">90 minutos</option>
                            <option value="Mais de 90 minutos">Mais de 90 minutos</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="equipmentAccess">Quais equipamentos você tem acesso?</label>
                        <textarea id="equipmentAccess" name="equipmentAccess" class="form-control" rows="3" placeholder="Ex: Halteres, elásticos, bicicleta ergométrica, etc."></textarea>
                    </div>
                </div>

                <!-- Tab 4: Dados da Dieta - Atualizada -->
                <div id="dietData" class="tab-content">
                    <div class="form-group">
                        <label for="mealsPerDay" class="required">Quantas refeições você faz por dia?</label>
                        <select id="mealsPerDay" name="mealsPerDay" class="form-control" required>
                            <option value="">Selecione...</option>
                            <option value="1-2">1-2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6 ou mais">6 ou mais</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Horários aproximados das refeições</label>
                        <textarea id="mealTimes" name="mealTimes" class="form-control" rows="3" placeholder="Ex: Café da manhã - 7h, Almoço - 12h30, Lanche - 16h, Jantar - 20h"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Quais destes alimentos você consome regularmente?</label>
                        
                        <div class="food-category">
                            <h3><i class="fas fa-bread-slice"></i> Carboidratos</h3>
                            <div class="food-grid">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo1" name="carbs" value="Arroz">
                                    <label for="carbo1">Arroz</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo2" name="carbs" value="Macarrão">
                                    <label for="carbo2">Macarrão</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo3" name="carbs" value="Pão">
                                    <label for="carbo3">Pão</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo4" name="carbs" value="Batata">
                                    <label for="carbo4">Batata</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo5" name="carbs" value="Mandioca">
                                    <label for="carbo5">Mandioca</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo6" name="carbs" value="Aveia">
                                    <label for="carbo6">Aveia</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo7" name="carbs" value="Quinoa">
                                    <label for="carbo7">Quinoa</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo8" name="carbs" value="Frutas">
                                    <label for="carbo8">Frutas</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo9" name="carbs" value="Cuscuz">
                                    <label for="carbo9">Cuscuz</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo10" name="carbs" value="Tapioca">
                                    <label for="carbo10">Tapioca</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo11" name="carbs" value="Pão integral">
                                    <label for="carbo11">Pão integral</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="carbo12" name="carbs" value="Batata-doce">
                                    <label for="carbo12">Batata-doce</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="food-category">
                            <h3><i class="fas fa-drumstick-bite"></i> Proteínas</h3>
                            <div class="food-grid">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein1" name="proteins" value="Carne vermelha">
                                    <label for="protein1">Carne vermelha</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein2" name="proteins" value="Frango">
                                    <label for="protein2">Frango</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein3" name="proteins" value="Peixe">
                                    <label for="protein3">Peixe</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein4" name="proteins" value="Ovos">
                                    <label for="protein4">Ovos</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein5" name="proteins" value="Queijo">
                                    <label for="protein5">Queijo</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein6" name="proteins" value="Iogurte">
                                    <label for="protein6">Iogurte</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein7" name="proteins" value="Feijão">
                                    <label for="protein7">Feijão</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein8" name="proteins" value="Lentilha">
                                    <label for="protein8">Lentilha</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein9" name="proteins" value="Tofu">
                                    <label for="protein9">Tofu</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein10" name="proteins" value="Peito de peru">
                                    <label for="protein10">Peito de peru</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein11" name="proteins" value="Camarão">
                                    <label for="protein11">Camarão</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="protein12" name="proteins" value="Grão-de-bico">
                                    <label for="protein12">Grão-de-bico</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="food-category">
                            <h3><i class="fas fa-oil-can"></i> Gorduras</h3>
                            <div class="food-grid">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="fat1" name="fats" value="Azeite de oliva">
                                    <label for="fat1">Azeite de oliva</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="fat2" name="fats" value="Abacate">
                                    <label for="fat2">Abacate</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="fat3" name="fats" value="Castanhas">
                                    <label for="fat3">Castanhas</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="fat4" name="fats" value="Manteiga">
                                    <label for="fat4">Manteiga</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="fat5" name="fats" value="Coco">
                                    <label for="fat5">Coco</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="fat6" name="fats" value="Sementes">
                                    <label for="fat6">Sementes (chia, linhaça, girassol)</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="fat7" name="fats" value="Azeitonas">
                                    <label for="fat7">Azeitonas</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="fat8" name="fats" value="Óleo de coco">
                                    <label for="fat8">Óleo de coco</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="food-category">
                            <h3><i class="fas fa-leaf"></i> Vegetais</h3>
                            <div class="food-grid">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg1" name="vegetables" value="Alface">
                                    <label for="veg1">Alface</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg2" name="vegetables" value="Tomate">
                                    <label for="veg2">Tomate</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg3" name="vegetables" value="Cenoura">
                                    <label for="veg3">Cenoura</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg4" name="vegetables" value="Brócolis">
                                    <label for="veg4">Brócolis</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg5" name="vegetables" value="Couve">
                                    <label for="veg5">Couve</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg6" name="vegetables" value="Abobrinha">
                                    <label for="veg6">Abobrinha</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg7" name="vegetables" value="Berinjela">
                                    <label for="veg7">Berinjela</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg8" name="vegetables" value="Pimentão">
                                    <label for="veg8">Pimentão</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg9" name="vegetables" value="Espinafre">
                                    <label for="veg9">Espinafre</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg10" name="vegetables" value="Rúcula">
                                    <label for="veg10">Rúcula</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg11" name="vegetables" value="Abóbora">
                                    <label for="veg11">Abóbora</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="veg12" name="vegetables" value="Chuchu">
                                    <label for="veg12">Chuchu</label>
                                </div>
                            </div>
                        </div>

                        <div class="other-foods">
                            <label for="otherFoods">Outros alimentos que consome regularmente (não listados acima)</label>
                            <textarea id="otherFoods" name="otherFoods" class="form-control" rows="3" placeholder="Ex: Pão de queijo, tapioca recheada, salada de frutas..."></textarea>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="waterIntake" class="required">Quantidade média de água consumida por dia</label>
                        <select id="waterIntake" name="waterIntake" class="form-control" required>
                            <option value="">Selecione...</option>
                            <option value="Menos de 1L">Menos de 1L</option>
                            <option value="1-1,5L">1-1,5L</option>
                            <option value="1,5-2L">1,5-2L</option>
                            <option value="2-3L">2-3L</option>
                            <option value="Mais de 3L">Mais de 3L</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="supplements">Usa algum suplemento alimentar?</label>
                        <textarea id="supplements" name="supplements" class="form-control" rows="3" placeholder="Se sim, quais e com que frequência?"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="foodRestriction">Restrições alimentares ou alimentos que não gosta</label>
                        <textarea id="foodRestriction" name="foodRestriction" class="form-control" rows="3" placeholder="Ex: Intolerância à lactose, não gosta de peixe, etc."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="dietGoal" class="required">Qual seu objetivo com a dieta?</label>
                        <select id="dietGoal" name="dietGoal" class="form-control" required>
                            <option value="">Selecione...</option>
                            <option value="Perda de peso">Perda de peso</option>
                            <option value="Ganho de massa muscular">Ganho de massa muscular</option>
                            <option value="Manutenção do peso">Manutenção do peso</option>
                            <option value="Melhora da saúde">Melhora da saúde</option>
                            <option value="Melhora do desempenho esportivo">Melhora do desempenho esportivo</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <div class="consent-term">
                            <div class="checkbox-item">
                                <input type="checkbox" id="consent" name="consent" required>
                                <label for="consent" class="required">Declaro que as informações fornecidas são verdadeiras e concordo com o tratamento dos meus dados para fins de consultoria online.</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="button-container">
                    <button type="button" id="prevBtn" class="btn btn-prev" disabled>
                        <i class="fas fa-arrow-left"></i> Voltar
                    </button>
                    <button type="button" id="nextBtn" class="btn btn-next">
                        Avançar <i class="fas fa-arrow-right"></i>
                    </button>
                    <button type="button" id="submitBtn" class="btn btn-submit" style="display: none;">
                        <i class="fas fa-paper-plane"></i> Enviar Questionário
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Aviso -->
    <div class="disclaimer-modal" id="disclaimerModal">
        <div class="disclaimer-content">
            <h2><i class="fas fa-exclamation-triangle"></i> Aviso Importante</h2>
            <p>"As orientações e sugestões de dieta fornecidas por mim como professor de educação física têm caráter geral e são baseadas nos objetivos discutidos. É importante lembrar que essas informações não substituem o trabalho de um nutricionista ou outro profissional capacitado na área de nutrição.</p>
            <p>Para garantir um acompanhamento adequado e específico às suas necessidades, recomendo fortemente a consulta com um profissional qualificado. Ressalto que seguir as sugestões fornecidas é uma decisão pessoal e, portanto, toda a responsabilidade recai sobre o aluno.</p>
            <p>Cuidar da saúde com orientação profissional é o melhor caminho para alcançar seus objetivos com segurança e eficácia!"</p>
            
            <div class="disclaimer-accept">
                <label>
                    <input type="checkbox" id="acceptDisclaimer">
                    Li e compreendi o aviso acima
                </label>
                <button type="button" id="confirmDisclaimer" disabled>Confirmar e Enviar</button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">Progresso salvo automaticamente</span>
    </div>

    <script>
        // Configuração do Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCaL12FjIF5SDCPPfy-Zi9_AngygcgeuKw",
            authDomain: "consultoria-online-c1a1d.firebaseapp.com",
            databaseURL: "https://consultoria-online-c1a1d-default-rtdb.firebaseio.com",
            projectId: "consultoria-online-c1a1d",
            storageBucket: "consultoria-online-c1a1d.appspot.com",
            messagingSenderId: "210625626529",
            appId: "1:210625626529:web:2515b369886f2d4abb8be0"
        };

        // Inicializa o Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Variáveis globais
        let currentTab = 0;
        const tabs = document.querySelectorAll('.tab-content');
        const tabButtons = document.querySelectorAll('.tab-button');
        const progressBar = document.getElementById('progressBar');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notificationText');

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Mostrar a primeira aba
            showTab(currentTab);
            
            // Configurar eventos
            setupEventListeners();
            
            // Carregar dados salvos
            loadFromLocalStorage();
        });

        // Função para configurar os event listeners
        function setupEventListeners() {
            // Botões das abas
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    currentTab = Array.from(tabButtons).indexOf(this);
                    showTab(currentTab);
                });
            });

            // Botões de navegação
            document.getElementById('prevBtn').addEventListener('click', prevTab);
            document.getElementById('nextBtn').addEventListener('click', nextTab);
            document.getElementById('submitBtn').addEventListener('click', validateForm);

            // Campos que precisam de formatação
            document.getElementById('phone').addEventListener('input', function() {
                formatPhone(this);
            });
            
            document.getElementById('cep').addEventListener('input', function() {
                formatCEP(this);
            });
            
            // Calcular idade quando a data de nascimento mudar
            document.getElementById('birthDate').addEventListener('change', function() {
                if (this.value) {
                    calculateAge(new Date(this.value));
                }
            });

            // Mostrar/ocultar campos de descrição condicionais
            document.getElementById('healthProblemYes').addEventListener('change', function() {
                document.getElementById('healthProblemDescription').style.display = this.checked ? 'block' : 'none';
                saveToLocalStorage();
            });
            
            document.getElementById('medicationYes').addEventListener('change', function() {
                document.getElementById('medicationDescription').style.display = this.checked ? 'block' : 'none';
                saveToLocalStorage();
            });
            
            document.getElementById('allergyYes').addEventListener('change', function() {
                document.getElementById('allergyDescription').style.display = this.checked ? 'block' : 'none';
                saveToLocalStorage();
            });
            
            document.getElementById('injuryYes').addEventListener('change', function() {
                document.getElementById('injuryDescription').style.display = this.checked ? 'block' : 'none';
                saveToLocalStorage();
            });

            // Upload de fotos
            document.getElementById('photoUpload').addEventListener('click', function() {
                document.getElementById('photoInput').click();
            });
            
            document.getElementById('photoInput').addEventListener('change', function() {
                handlePhotoUpload(this);
            });

            // Calcular IMC
            document.getElementById('calculateBMI').addEventListener('click', calculateBMI);

            // Salvar automaticamente quando os campos mudarem
            const formInputs = document.querySelectorAll('#consultationForm input, #consultationForm select, #consultationForm textarea');
            formInputs.forEach(input => {
                input.addEventListener('change', saveToLocalStorage);
                input.addEventListener('blur', saveToLocalStorage);
            });

            // Modal de aviso
            document.getElementById('acceptDisclaimer').addEventListener('change', function() {
                document.getElementById('confirmDisclaimer').disabled = !this.checked;
            });

            document.getElementById('confirmDisclaimer').addEventListener('click', function() {
                sendDataToFirebase();
            });
        }

        // Função para mostrar uma aba específica
        function showTab(tabIndex) {
            // Esconder todas as abas
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remover a classe 'active' de todos os botões
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            // Mostrar a aba atual e ativar o botão correspondente
            tabs[tabIndex].classList.add('active');
            tabButtons[tabIndex].classList.add('active');
            
            // Atualizar a barra de progresso
            updateProgressBar(tabIndex);
            
            // Atualizar a visibilidade dos botões
            updateButtonVisibility();
        }

        // Função para avançar para a próxima aba
        function nextTab() {
            if (validateTab(currentTab)) {
                currentTab++;
                showTab(currentTab);
            }
        }

        // Função para voltar para a aba anterior
        function prevTab() {
            currentTab--;
            showTab(currentTab);
        }

        // Função para atualizar a barra de progresso
        function updateProgressBar(tabIndex) {
            const progress = ((tabIndex + 1) / tabs.length) * 100;
            progressBar.style.width = `${progress}%`;
        }

        // Função para atualizar a visibilidade dos botões
        function updateButtonVisibility() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const submitBtn = document.getElementById('submitBtn');
            
            // Primeira aba
            if (currentTab === 0) {
                prevBtn.disabled = true;
                nextBtn.style.display = 'flex';
                submitBtn.style.display = 'none';
            } 
            // Última aba
            else if (currentTab === tabs.length - 1) {
                prevBtn.disabled = false;
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'flex';
            } 
            // Abas intermediárias
            else {
                prevBtn.disabled = false;
                nextBtn.style.display = 'flex';
                submitBtn.style.display = 'none';
            }
        }

        // Função para validar a aba atual
        function validateTab(tabIndex) {
            let isValid = true;
            const currentTab = tabs[tabIndex];
            const requiredInputs = currentTab.querySelectorAll('[required]');
            
            // Validações específicas para a aba de Dados Pessoais
            if (tabIndex === 0) {
                // Validar e-mail
                const email = document.getElementById('email').value;
                if (!validateEmail(email)) {
                    document.getElementById('email-error').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('email-error').style.display = 'none';
                }
                
                // Validar telefone
                const phone = document.getElementById('phone').value;
                if (!validatePhone(phone)) {
                    document.getElementById('phone-error').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('phone-error').style.display = 'none';
                }
                
                // Validar data de nascimento
                const birthDate = document.getElementById('birthDate').value;
                if (!validateBirthDate(birthDate)) {
                    document.getElementById('birthdate-error').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('birthdate-error').style.display = 'none';
                }
                
                // Validar CEP
                const cep = document.getElementById('cep').value;
                if (!validateCEP(cep)) {
                    document.getElementById('cep-error').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('cep-error').style.display = 'none';
                }
            }
            
            // Validação padrão dos campos obrigatórios
            for (let i = 0; i < requiredInputs.length; i++) {
                const input = requiredInputs[i];
                if (input.type === 'checkbox' || input.type === 'radio') {
                    const name = input.name;
                    const checked = currentTab.querySelector(`input[name="${name}"]:checked`);
                    if (!checked) {
                        isValid = false;
                        input.parentElement.style.color = 'var(--danger)';
                    } else {
                        input.parentElement.style.color = '';
                    }
                } else if (!input.value) {
                    isValid = false;
                    input.style.borderColor = 'var(--danger)';
                } else {
                    input.style.borderColor = '';
                }
            }
            
            if (!isValid) {
                showNotification('Por favor, preencha todos os campos obrigatórios corretamente.', 'error');
                // Rolar para o primeiro erro
                const firstError = currentTab.querySelector('[style*="border-color: var(--danger)"]') || 
                                 currentTab.querySelector('[style*="color: var(--danger)"]');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            } else {
                saveToLocalStorage();
            }
            
            return isValid;
        }

        // Função para validar o formulário completo
        function validateForm() {
            if (validateTab(currentTab)) {
                // Mostrar o modal de aviso em vez de enviar diretamente
                document.getElementById('disclaimerModal').style.display = 'flex';
            }
        }

        // Nova função para enviar dados ao Firebase
        function sendDataToFirebase() {
            const form = document.getElementById('consultationForm');
            const formData = new FormData(form);
            const data = {};
            
            // Converter FormData para objeto simples
            formData.forEach((value, key) => {
                // Para checkboxes e radios com múltiplos valores
                if (key === 'availableDays' || key === 'carbs' || key === 'proteins' || 
                    key === 'fats' || key === 'vegetables') {
                    if (!data[key]) {
                        data[key] = [];
                    }
                    data[key].push(value);
                } else {
                    data[key] = value;
                }
            });

            // Adiciona timestamp
            data.timestamp = firebase.database.ServerValue.TIMESTAMP;
            
            // Envia para o Firebase
            const newConsultationRef = database.ref('consultations').push();
            newConsultationRef.set(data)
                .then(() => {
                    showNotification('Dados enviados com sucesso!', 'success');
                    
                    // Fechar o modal
                    document.getElementById('disclaimerModal').style.display = 'none';
                    
                    // Limpar o formulário e localStorage
                    setTimeout(() => {
                        form.reset();
                        localStorage.removeItem('consultationFormData');
                        currentTab = 0;
                        showTab(currentTab);
                    }, 2000);
                })
                .catch((error) => {
                    showNotification('Erro ao enviar dados: ' + error.message, 'error');
                });
        }

        // Função para salvar os dados no localStorage
        function saveToLocalStorage() {
            const formData = new FormData(document.getElementById('consultationForm'));
            const data = {};
            
            formData.forEach((value, key) => {
                // Para checkboxes e radios, precisamos pegar todos os valores selecionados
                if (key === 'availableDays' || key === 'carbs' || key === 'proteins' || key === 'fats' || key === 'vegetables') {
                    if (!data[key]) {
                        data[key] = [];
                    }
                    data[key].push(value);
                } else {
                    data[key] = value;
                }
            });
            
            // Converter arrays para strings para armazenamento
            for (const key in data) {
                if (Array.isArray(data[key])) {
                    data[key] = JSON.stringify(data[key]);
                }
            }
            
            localStorage.setItem('consultationFormData', JSON.stringify(data));
            showNotification('Progresso salvo automaticamente', 'success');
        }

        // Função para carregar os dados do localStorage
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('consultationFormData');
            if (savedData) {
                const data = JSON.parse(savedData);
                
                for (const key in data) {
                    // Verificar se é um array armazenado como string
                    if (data[key] && typeof data[key] === 'string' && data[key].startsWith('[')) {
                        const arrayData = JSON.parse(data[key]);
                        const elements = document.querySelectorAll(`input[name="${key}"]`);
                        
                        elements.forEach(element => {
                            if (arrayData.includes(element.value)) {
                                element.checked = true;
                            }
                        });
                    } else {
                        const element = document.querySelector(`[name="${key}"]`);
                        if (element) {
                            if (element.type === 'radio' || element.type === 'checkbox') {
                                if (element.value === data[key]) {
                                    element.checked = true;
                                }
                            } else {
                                element.value = data[key];
                            }
                        }
                    }
                }
                
                // Atualizar campos condicionais
                if (data.healthProblem === 'Sim') {
                    document.getElementById('healthProblemDescription').style.display = 'block';
                }
                if (data.medication === 'Sim') {
                    document.getElementById('medicationDescription').style.display = 'block';
                }
                if (data.allergy === 'Sim') {
                    document.getElementById('allergyDescription').style.display = 'block';
                }
                if (data.injury === 'Sim') {
                    document.getElementById('injuryDescription').style.display = 'block';
                }
                
                // Atualizar idade se existir data de nascimento
                if (data.birthDate) {
                    calculateAge(new Date(data.birthDate));
                }
                
                showNotification('Dados anteriores carregados com sucesso', 'success');
            }
        }

        // Função para calcular idade a partir da data de nascimento
        function calculateAge(birthDate) {
            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const monthDiff = today.getMonth() - birthDate.getMonth();
            
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }
            
            document.getElementById('ageDisplay').textContent = `${age} anos`;
            return age;
        }

        // Função para calcular IMC
        function calculateBMI() {
            const height = parseFloat(document.getElementById('height').value) / 100; // converter cm para m
            const weight = parseFloat(document.getElementById('weight').value);
            
            if (height && weight) {
                const bmi = (weight / (height * height)).toFixed(1);
                let classification = '';
                let color = '';
                
                if (bmi < 18.5) {
                    classification = 'Abaixo do peso';
                    color = 'var(--warning)';
                } else if (bmi < 25) {
                    classification = 'Peso normal';
                    color = 'var(--success)';
                } else if (bmi < 30) {
                    classification = 'Sobrepeso';
                    color = 'var(--warning)';
                } else if (bmi < 35) {
                    classification = 'Obesidade Grau I';
                    color = 'var(--danger)';
                } else if (bmi < 40) {
                    classification = 'Obesidade Grau II';
                    color = 'var(--danger)';
                } else {
                    classification = 'Obesidade Grau III';
                    color = 'var(--danger)';
                }
                
                document.getElementById('bmiValue').textContent = bmi;
                document.getElementById('bmiValue').style.color = color;
                document.getElementById('bmiClassification').textContent = classification;
                document.getElementById('bmiClassification').style.color = color;
                document.getElementById('bmiResult').style.display = 'block';
                
                saveToLocalStorage();
            } else {
                showNotification('Por favor, preencha altura e peso para calcular o IMC', 'error');
            }
        }

        // Função para lidar com upload de fotos
        function handlePhotoUpload(input) {
            const preview = document.getElementById('photoPreview');
            preview.innerHTML = '';
            
            if (input.files && input.files.length > 0) {
                preview.style.display = 'block';
                
                for (let i = 0; i < Math.min(input.files.length, 3); i++) {
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        preview.appendChild(img);
                    }
                    
                    reader.readAsDataURL(input.files[i]);
                }
                
                if (input.files.length > 3) {
                    const moreText = document.createElement('p');
                    moreText.textContent = `+${input.files.length - 3} imagens`;
                    preview.appendChild(moreText);
                }
                
                showNotification(`${input.files.length} foto(s) adicionada(s)`, 'success');
            }
        }

        // Funções de validação
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        function validatePhone(phone) {
            const re = /^\(\d{2}\) \d{4,5}-\d{4}$/;
            return re.test(phone);
        }

        function validateCEP(cep) {
            const re = /^\d{5}-?\d{3}$/;
            return re.test(cep);
        }

        function validateBirthDate(date) {
            const birthDate = new Date(date);
            const today = new Date();
            
            // Verificar se a data é válida
            if (isNaN(birthDate.getTime())) {
                return false;
            }
            
            // Verificar se a data não é no futuro
            if (birthDate > today) {
                return false;
            }
            
            // Verificar se a idade é pelo menos 12 anos
            const age = calculateAge(birthDate);
            return age >= 12;
        }

        // Funções de formatação
        function formatPhone(input) {
            let value = input.value.replace(/\D/g, '');
            
            if (value.length > 2) {
                value = `(${value.substring(0, 2)}) ${value.substring(2)}`;
            }
            if (value.length > 10) {
                value = `${value.substring(0, 10)}-${value.substring(10, 14)}`;
            }
            
            input.value = value;
        }

        function formatCEP(input) {
            let value = input.value.replace(/\D/g, '');
            
            if (value.length > 5) {
                value = `${value.substring(0, 5)}-${value.substring(5, 8)}`;
            }
            
            input.value = value;
        }

        // Função para mostrar notificações
        function showNotification(message, type) {
            notificationText.textContent = message;
            
            // Definir cor com base no tipo
            switch (type) {
                case 'success':
                    notification.style.backgroundColor = 'var(--success)';
                    break;
                case 'error':
                    notification.style.backgroundColor = 'var(--danger)';
                    break;
                case 'warning':
                    notification.style.backgroundColor = 'var(--warning)';
                    break;
                case 'info':
                    notification.style.backgroundColor = 'var(--info)';
                    break;
                default:
                    notification.style.backgroundColor = 'var(--primary)';
            }
            
            // Mostrar notificação
            notification.classList.add('show');
            
            // Esconder após 3 segundos
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>